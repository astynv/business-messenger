# üí¨ –ö–æ–†–ø–û—Ä–ê—Ç–ò–≤–ù—ã–ô –ú–µ–°—Å–ï–Ω–î–∂–ï—Ä üí¨

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤:

–°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/SkyFerry17/messenger.git
```

–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º:

```bash
cd messenger
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
npm i
```

–ó–∞–ø—É—Å—Ç–∏—Ç—å dev-—Å–µ—Ä–≤–µ—Ä —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:

```bash
npm start
```

–í –æ—Ç–¥–µ–ª—å–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä:

```bash
FRONTEND=dev \
MONGO_URL="mongodb+srv://..." \
npm run serve-dev
```

–ó–∞–ø—É—â–µ–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –≤ –∏—Å—Ö–æ–¥–Ω–∏–∫–∞—Ö. 

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ —Å–µ—Ä–≤–∏—Å–∞ (—Å –¥–æ–∫–µ—Ä–æ–º):

–°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/SkyFerry17/messenger.git
```

–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º:

```bash
cd messenger
```

–°–æ–±—Ä–∞—Ç—å Docker-–æ–±—Ä–∞–∑:

```bash
docker build -t skyferry/messenger .
```

–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ–±—Ä–∞–∑ –≤ —Ñ–∞–π–ª:

```bash
docker save -o docker-image.tar skyferry/messenger
```

–ò–ª–∏:

```bash
docker save skyferry/messenger | gzip > docker-image.tar.gz
```

–°–º–µ–Ω–∏—Ç—å Docker-–∫–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Å–µ—Ä–≤–µ—Ä—É:

```bash
docker context use your-context
```

–ó–∞–≥—Ä—É–∑–∏—Ç—å Docker-–æ–±—Ä–∞–∑ –∏–∑ —Ñ–∞–π–ª–∞:

```bash
docker load -i docker-image.tar
```

–ò–ª–∏:

```bash
docker load -i docker-image.tar.gz
```

–ó–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:

```bash
docker run -p 5000:5000 -d --env \
MONGO_URL="mongodb+srv://..." \
skyferry/messenger
```

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ —Å–µ—Ä–≤–∏—Å–∞ (–±–µ–∑ –¥–æ–∫–µ—Ä–∞):

–°–∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```bash
git clone https://github.com/SkyFerry17/messenger.git
```

–ü–µ—Ä–µ–π—Ç–∏ –≤ –ø–∞–ø–∫—É —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º:

```bash
cd messenger
```

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
npm i
```

–í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–±–æ—Ä–∫—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞:

```bash
npm run build
```

–°–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±—ç–∫–µ–Ω–¥:

```bash
MONGO_URL="mongodb+srv://..." \
npm run serve
```

## –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

1. `HTTP` ‚Äî –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–µ—Ä–µ–¥–∞—á–∏ –≥–∏–ø–µ—Ä—Ç–µ–∫—Å—Ç–∞ –ø–æ–≤–µ—Ä—Ö TCP –ø–æ —Å—Ö–µ–º–µ –∑–∞–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç;
2. `WebSockets` ‚Äî –ø—Ä–æ—Ç–æ–∫–æ–ª —Å–≤—è–∑–∏ –ø–æ–≤–µ—Ä—Ö TCP, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –¥–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ –æ–±–º–µ–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –º–µ–∂–¥—É –±—Ä–∞—É–∑–µ—Ä–æ–º –∏ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–æ–º –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å —Ç–µ—Ö–Ω–∏–∫–æ–π long polling;
3. `TypeScript` ‚Äî –Ω–∞–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ JS —Å–æ —Å—Ç—Ä–æ–≥–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ç–∏–ø–æ–≤, –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å Flow –∏–ª–∏ Dart;
4. `StandardJS`, –∞ —Ç–æ—á–Ω–µ–µ `ts-standard` –ø—Ä–∏—è—Ç–Ω—ã–π –≥–ª–∞–∑—É —Å—Ç–∞–Ω–¥a—Ä—Ç –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞ JS|TS, –∏–º–µ—é—â–∏–π –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–µ –ª–∏–Ω—Ç–µ—Ä—ã –∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è;
5. `Node.js` ‚Äî JS-—Ä–∞–Ω—Ç–∞–π–º –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞, —Å—Ä–∞–≤–Ω–∏–º —Å Deno;
6. `Express.js` ‚Äî –±—ã—Å—Ç—Ä—ã–π –∏ —É–¥–æ–±–Ω—ã–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è Node.js;
7. `MongoDB` ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ–∫–æ–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–∞—è –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è NoSQL –°–£–ë–î;
7. `Docker` ‚Äî –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –≤ —Å—Ä–µ–¥–∞—Ö —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏–∏;
8. `MikroORM` ‚Äî ORM –¥–ª—è TypeScript, –∏—Å–ø–æ–ª—å–∑—É—é—â–∞—è —Ä–µ—Ñ–ª–µ–∫—Å–∏—é –Ω–∞ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞—Ö –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å —Å TypeORM –∏ Mongoose;
9. `React.js` ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ —Å–ª–æ–∂–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –±—Ä–∞—É–∑–µ—Ä–µ;
10. `Redux` ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è;
11. `styled-components` ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º css-in-js üíÖüèæüíÖüèæüíÖüèæ;
12. `react-redux` ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–≤—è–∑–∏ React –∏ Redux;
13. `React Router` ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ React;
14. `connected-react-router` ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–≤—è–∑–∏ React Router –∏ Redux.

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–ª–ª–µ–∫—Ü–∏–∏

1. `User` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:
    1. `username` ‚Äî *string*;
    2. `email` ‚Äî *string*;
    3. `passwordHash` ‚Äî *string* ‚Äî bcrypt-—Ö–µ—à –ø–∞—Ä–æ–ª—è;
    4. `firstName` ‚Äî *string*;
    5. `lastName` ‚Äî *string*;
    6. `tokens` ‚Äî *Token[]*;
    7. `chats` ‚Äî *Chat[]*;
    8. `todos` ‚Äî *Todo[]*;
    9. `avatar` ‚Äî *BLOB?*;
    10. `lastSeen` ‚Äî *Date*;
2. `Token` ‚Äî —Ç–æ–∫–µ–Ω—ã –¥–æ—Å—Ç—É–ø–∞:
    1. `user` ‚Äî *User*;
    2. `token` ‚Äî *string* ‚Äî —Å–∞–º —Ç–æ–∫–µ–Ω;
    3. `issued` ‚Äî *Date* ‚Äî –¥–∞—Ç–∞ –≤—ã–¥–∞—á–∏;
    4. `userAgent` ‚Äî *string* ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è-–∫–ª–∏–µ–Ω—Ç–∞;
3. `Chat` ‚Äî –¥–∏–∞–ª–æ–≥–∏:
    1. `direct` ‚Äî *boolean* ‚Äî —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ª–∏—á–∫–æ–π;
    2. `members` ‚Äî *User[]*;
    3. `messages` ‚Äî *Message[]*;
    4. `attachments` ‚Äî *File[]*;
    5. `todos` ‚Äî *Todo[]*;
    6. `title` ‚Äî *string?*;
    7. `avatar` ‚Äî *BLOB?*;
4. `Message` ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è:
    1. `chat` ‚Äî *Chat*;
    2. `date` ‚Äî *Date*;
    3. `sender` ‚Äî *User*;
    4. `type` ‚Äî *enum MessageType*:
        1. `DEFAULT` ‚Äî –æ–±—ã—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å —Ç–µ–∫—Å—Ç–æ–º –∏–ª–∏ –≤–ª–æ–∂–µ–Ω–∏—è–º–∏;
        2. `CREATED` ‚Äî —Å–µ—Ä–≤–∏—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è —á–∞—Ç–∞: ¬´X created the chat¬ª;
        3. `JOINED` ‚Äî —Å–µ—Ä–≤–∏—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ —á–∞—Ç: ¬´X joined the chat¬ª;
        4. `LEFT` ‚Äî —Å–µ—Ä–≤–∏—Å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ —á–∞—Ç–∞: ¬´X left the chat;
    5. `attachments` ‚Äî *File[]*;
    6. `text` ‚Äî *string?*;
    7. `readBy` ‚Äî *User[]*
5. `Todo` ‚Äî –∑–∞–¥–∞—á–∞ –≤ —á–∞—Ç–µ:
    1. `chat` ‚Äî *Chat*;
    2. `title` ‚Äî *string*;
    3. `description` ‚Äî *string?*;
    4. `assigned` ‚Äî *User?*;
    5. `completed` ‚Äî *boolean*;
6. `File` ‚Äî —Ñ–∞–π–ª:
    1. `title` ‚Äî *string*;
    2. `type` ‚Äî *enum FileType*:
        1. `GENERIC` ‚Äî –æ–±—ã—á–Ω—ã–π —Ñ–∞–π–ª;
        2. `IMAGE` ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ;
    3. `owner` ‚Äî *User*;
    4. `uploaded` ‚Äî *Date* ‚Äî –¥–∞—Ç–∞ –∑–∞–≥—Ä—É–∑–∫–∏;
    5. `body` ‚Äî *BLOB*.

### –û—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏

* `User` ‚Äî
    - `Token`: *1-n* ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç —Ç–æ–∫–µ–Ω—ã;
    - `Chat`: *n-n* ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ—Å—Ç–æ—è—Ç –≤ —á–∞—Ç–∞—Ö;
    - `Message`: *1-n* ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–∏–ª —Å–æ–æ–±—â–µ–Ω–∏—è;
    - `Todo`: *1-n* ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –∑–∞–¥–∞—á–∏;
    - `File`: *1-n* ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∑–∏–ª —Ñ–∞–π–ª—ã;
* `Token` ‚Äî
    - `User`: *n-1* ‚Äî —Ç–æ–∫–µ–Ω –≤—ã–¥–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é;
* `Chat` ‚Äî
    - `User`: *n-n* ‚Äî —á–∞—Ç—ã —Å–æ–¥–µ—Ä–∂–∞—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤;
    - `Message`: *1-n* ‚Äî —á–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏—è;
    - `Todo`: *1-n* ‚Äî —á–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–¥–∞—á–∏;
    - `File`: *n-n* ‚Äî –≤ —á–∞—Ç–∞—Ö –µ—Å—Ç—å –≤–ª–æ–∂–µ–Ω–∏—è;
* `Message` ‚Äî
    - `User`: *n-1* ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã [–æ–¥–Ω–∏–º] –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º;
    - `User`: *n-n* ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è –ø—Ä–æ—á–∏—Ç–∞–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏;
    - `Chat`: *n-1* ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ —á–∞—Ç;
    - `File`: *1-n* ‚Äî —É —Å–æ–æ–±—â–µ–Ω–∏—è –µ—Å—Ç—å –≤–ª–æ–∂–µ–Ω–∏—è;
* `Todo` ‚Äî
    - `User`: *n-1* ‚Äî –∑–∞–¥–∞—á–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é;
    - `Chat`: *n-1* ‚Äî –∑–∞–¥–∞—á–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —á–∞—Ç–µ;
* `File` ‚Äî
    - `User`: *n-1* ‚Äî —Ñ–∞–π–ª—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º;
    - `Message`: *n-1* ‚Äî —Ñ–∞–π–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω—ã –∫ —Å–æ–æ–±—â–µ–Ω–∏—é;
